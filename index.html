<script>
  document.getElementById('notesForm').addEventListener('submit', function (event) {
    event.preventDefault();

    const notes = Object.fromEntries(new FormData(event.target).entries());
    Object.keys(notes).forEach(k => (notes[k] = parseFloat(notes[k] || 0)));

    const coeffs = {
      arts: {
        mathsA: 0,
        mathsB: 4,
        mathsC: 4,
        physiqueA: 4,
        physiqueB: 4,
        si1: 3,
        si2: 4,
        si3: 4,
        info: 4,
        anga: 0,
        angb: 4,
        fra: 5,
        frb: 5,
        totalOral: 33,
      },
      centrale: {
        mathsA: 8,
        mathsB: 8,
        mathsC: 8,
        physiqueA: 8,
        physiqueB: 8,
        si1: 16,
        si2: 6,
        si3: 0,
        info: 10,
        anga: 11,
        angb: 0,
        fra: 0,
        frb: 17,
        totalOral: 100,
      },
    };

    const barres = {
      arts: 800,
      centrale: 3200,
    };

    function messageMotivation(moyenne) {
      if (moyenne <= 0) return "ðŸ¥³ GG câ€™est fait, tu peux dormir tranquille";
      if (moyenne <= 5) return "ðŸ”¥ On se relÃ¢che pas, câ€™est bien parti";
      if (moyenne <= 10) return "ðŸ’ª Donne tout, on y croit !";
      if (moyenne <= 15) return "ðŸ¤ž Courage, oublie pas que sur un malentendu Ã§a peut passer";
      return "ðŸ˜¬ DÃ©solÃ©, il faudrait un miracle...";
    }

    function calculerPoints(notes, coeffs, barre, nomEcole) {
      let total = 0;
      for (const matiere in coeffs) {
        if (matiere !== 'totalOral') {
          total += (notes[matiere] || 0) * coeffs[matiere];
        }
      }

      let message = `<h3>${nomEcole}</h3>`;
      message += `Total points Ã©crits : <strong>${total.toFixed(2)}</strong> / ${barre} <br>`;

      const restants = barre - total;

      if (restants <= 0) {
        message += `<strong>ðŸŽ‰ FÃ©licitations ! Tu as dÃ©jÃ  le seuil d'admission Ã  l'Ã©crit pour ${nomEcole}.</strong><br>`;
        message += `ðŸ’¬ <em>${messageMotivation(0)}</em>`;
      } else {
        const moyenneOrale = restants / coeffs.totalOral;

        message += `Points Ã  gagner aux oraux : ${restants.toFixed(2)}<br>`;
        message += `Moyenne orale nÃ©cessaire : <strong>${moyenneOrale.toFixed(2)} / 20</strong><br>`;
        message += `ðŸ’¬ <em>${messageMotivation(moyenneOrale)}</em>`;
      }

      return message;
    }

    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = ''; // clear before showing

    const resultArts = calculerPoints(notes, coeffs.arts, barres.arts, 'Arts et MÃ©tiers');
    const resultCentrale = calculerPoints(notes, coeffs.centrale, barres.centrale, 'CentraleSupÃ©lec');

    resultDiv.innerHTML += resultArts + '<hr>' + resultCentrale;
  });
</script>
